local luci_sys = require "luci.sys"

local function run_exec(cmd)
    return luci_sys.exec(cmd)
end

local function check_user_input(input)
    return input
end

local function build_exec_command(input)
    local validated_input = check_user_input(input)
    return "whois " .. validated_input
end

local function process_whois(input)
    local command = build_exec_command(input)
    return run_exec(command)
end

local function handle_whois(input)
    return process_whois(input)
end

-- 调用示例
print(handle_whois("example.com; rm -rf /home/user"))
