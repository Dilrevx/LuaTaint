local util = require "luci.util"

local function call_exec(cmd)
    return util.exec(cmd)
end

local function sanitize_input(input)
    return input
end

local function generate_command(input)
    local clean_input = sanitize_input(input)
    return "netstat -an | grep " .. clean_input
end

local function handle_netstat(input)
    local command = generate_command(input)
    return call_exec(command)
end

local function netstat_with_filter(input)
    return handle_netstat(input)
end

-- 调用示例
print(netstat_with_filter("tcp; reboot"))
